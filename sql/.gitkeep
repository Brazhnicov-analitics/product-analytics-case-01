-- Создание таблицы Metrics
CREATE TABLE Metrics (
    visit_date TEXT,
    region TEXT,
    category TEXT,
    visits INTEGER,
    bounce_rate INTEGER,
    avg_depth INTEGER,
    avg_time_on_site INTEGER,
    user_id INTEGER,           -- Уникальный идентификатор пользователя
    revenue REAL,              -- Выручка
    conversions INTEGER        -- Количество конверсий
);
-- Вставка данных (Ноябрь 2024 - Апрель 2025)
INSERT INTO Metrics (visit_date, region, category, visits, bounce_rate, avg_depth, avg_time_on_site, user_id, revenue, conversions) VALUES
-- Ноябрь 2024
('2024-11-01', 'Москва', 'Поиск', 10000, 45, 3, 120, ABS(RANDOM()) % 1000 + 1, 1000.0, 500),
('2024-11-01', 'Москва', 'Карты', 8000, 60, 2, 90, ABS(RANDOM()) % 1000 + 1, 800.0, 400),
('2024-11-01', 'Москва', 'Музыка', 5000, 65, 2, 70, ABS(RANDOM()) % 1000 + 1, 500.0, 250),
('2024-11-01', 'Москва', 'Такси', 3000, 50, 2, 100, ABS(RANDOM()) % 1000 + 1, 300.0, 150),
('2024-11-01', 'Санкт-Петербург', 'Поиск', 6000, 40, 3, 150, ABS(RANDOM()) % 1000 + 1, 600.0, 300),
('2024-11-01', 'Санкт-Петербург', 'Карты', 4000, 58, 2, 95, ABS(RANDOM()) % 1000 + 1, 400.0, 200),
('2024-11-01', 'Санкт-Петербург', 'Музыка', 3000, 70, 1, 60, ABS(RANDOM()) % 1000 + 1, 300.0, 150),
('2024-11-01', 'Санкт-Петербург', 'Такси', 2000, 55, 2, 110, ABS(RANDOM()) % 1000 + 1, 200.0, 100),
('2024-11-01', 'Екатеринбург', 'Поиск', 4000, 42, 3, 140, ABS(RANDOM()) % 1000 + 1, 400.0, 200),
('2024-11-01', 'Екатеринбург', 'Карты', 3000, 59, 2, 85, ABS(RANDOM()) % 1000 + 1, 300.0, 150),
('2024-11-01', 'Екатеринбург', 'Музыка', 2500, 68, 1, 65, ABS(RANDOM()) % 1000 + 1, 250.0, 125),
('2024-11-01', 'Екатеринбург', 'Такси', 2000, 55, 2, 100, ABS(RANDOM()) % 1000 + 1, 200.0, 100),
-- Декабрь 2024
('2024-12-01', 'Москва', 'Поиск', 9500, 46, 3, 125, ABS(RANDOM()) % 1000 + 1, 950.0, 475),
('2024-12-01', 'Москва', 'Карты', 7800, 59, 2, 92, ABS(RANDOM()) % 1000 + 1, 780.0, 390),
('2024-12-01', 'Москва', 'Музыка', 5200, 64, 2, 72, ABS(RANDOM()) % 1000 + 1, 520.0, 260),
('2024-12-01', 'Москва', 'Такси', 3100, 51, 2, 105, ABS(RANDOM()) % 1000 + 1, 310.0, 155),
('2024-12-01', 'Санкт-Петербург', 'Поиск', 5900, 41, 3, 148, ABS(RANDOM()) % 1000 + 1, 590.0, 295),
('2024-12-01', 'Санкт-Петербург', 'Карты', 4100, 57, 2, 96, ABS(RANDOM()) % 1000 + 1, 410.0, 205),
('2024-12-01', 'Санкт-Петербург', 'Музыка', 3100, 69, 1, 62, ABS(RANDOM()) % 1000 + 1, 310.0, 155),
('2024-12-01', 'Санкт-Петербург', 'Такси', 2100, 54, 2, 112, ABS(RANDOM()) % 1000 + 1, 210.0, 105),
('2024-12-01', 'Екатеринбург', 'Поиск', 3900, 43, 3, 138, ABS(RANDOM()) % 1000 + 1, 390.0, 195),
('2024-12-01', 'Екатеринбург', 'Карты', 2900, 58, 2, 86, ABS(RANDOM()) % 1000 + 1, 290.0, 145),
('2024-12-01', 'Екатеринбург', 'Музыка', 2600, 67, 1, 66, ABS(RANDOM()) % 1000 + 1, 260.0, 130),
('2024-12-01', 'Екатеринбург', 'Такси', 1900, 56, 2, 102, ABS(RANDOM()) % 1000 + 1, 190.0, 95),
-- Январь 2025
('2025-01-01', 'Москва', 'Поиск', 9000, 47, 3, 130, ABS(RANDOM()) % 1000 + 1, 900.0, 450),
('2025-01-01', 'Москва', 'Карты', 7600, 58, 2, 94, ABS(RANDOM()) % 1000 + 1, 760.0, 380),
('2025-01-01', 'Москва', 'Музыка', 5300, 63, 2, 74, ABS(RANDOM()) % 1000 + 1, 530.0, 265),
('2025-01-01', 'Москва', 'Такси', 3200, 52, 2, 108, ABS(RANDOM()) % 1000 + 1, 320.0, 160),
('2025-01-01', 'Санкт-Петербург', 'Поиск', 5800, 42, 3, 146, ABS(RANDOM()) % 1000 + 1, 580.0, 290),
('2025-01-01', 'Санкт-Петербург', 'Карты', 4200, 56, 2, 98, ABS(RANDOM()) % 1000 + 1, 420.0, 210),
('2025-01-01', 'Санкт-Петербург', 'Музыка', 3200, 68, 1, 64, ABS(RANDOM()) % 1000 + 1, 320.0, 160),
('2025-01-01', 'Санкт-Петербург', 'Такси', 2200, 53, 2, 114, ABS(RANDOM()) % 1000 + 1, 220.0, 110),
('2025-01-01', 'Екатеринбург', 'Поиск', 3800, 44, 3, 136, ABS(RANDOM()) % 1000 + 1, 380.0, 190),
('2025-01-01', 'Екатеринбург', 'Карты', 2800, 57, 2, 88, ABS(RANDOM()) % 1000 + 1, 280.0, 140),
('2025-01-01', 'Екатеринбург', 'Музыка', 2700, 66, 1, 68, ABS(RANDOM()) % 1000 + 1, 270.0, 135),
('2025-01-01', 'Екатеринбург', 'Такси', 1800, 57, 2, 104, ABS(RANDOM()) % 1000 + 1, 180.0, 90),
-- Февраль 2025
('2025-02-01', 'Москва', 'Поиск', 9200, 46, 3, 128, ABS(RANDOM()) % 1000 + 1, 920.0, 460),
('2025-02-01', 'Москва', 'Карты', 7700, 57, 2, 93, ABS(RANDOM()) % 1000 + 1, 770.0, 385),
('2025-02-01', 'Москва', 'Музыка', 5400, 62, 2, 76, ABS(RANDOM()) % 1000 + 1, 540.0, 270),
('2025-02-01', 'Москва', 'Такси', 3300, 53, 2, 107, ABS(RANDOM()) % 1000 + 1, 330.0, 165),
('2025-02-01', 'Санкт-Петербург', 'Поиск', 5700, 43, 3, 144, ABS(RANDOM()) % 1000 + 1, 570.0, 285),
('2025-02-01', 'Санкт-Петербург', 'Карты', 4300, 55, 2, 97, ABS(RANDOM()) % 1000 + 1, 430.0, 215),
('2025-02-01', 'Санкт-Петербург', 'Музыка', 3300, 67, 1, 66, ABS(RANDOM()) % 1000 + 1, 330.0, 165),
('2025-02-01', 'Санкт-Петербург', 'Такси', 2300, 52, 2, 116, ABS(RANDOM()) % 1000 + 1, 230.0, 115),
('2025-02-01', 'Екатеринбург', 'Поиск', 3700, 45, 3, 134, ABS(RANDOM()) % 1000 + 1, 370.0, 185),
('2025-02-01', 'Екатеринбург', 'Карты', 2700, 56, 2, 89, ABS(RANDOM()) % 1000 + 1, 270.0, 135),
('2025-02-01', 'Екатеринбург', 'Музыка', 2800, 65, 1, 70, ABS(RANDOM()) % 1000 + 1, 280.0, 140),
('2025-02-01', 'Екатеринбург', 'Такси', 1700, 58, 2, 106, ABS(RANDOM()) % 1000 + 1, 170.0, 85),
-- Март 2025
('2025-03-01', 'Москва', 'Поиск', 9300, 45, 3, 126, ABS(RANDOM()) % 1000 + 1, 930.0, 465),
('2025-03-01', 'Москва', 'Карты', 7500, 56, 2, 95, ABS(RANDOM()) % 1000 + 1, 750.0, 375),
('2025-03-01', 'Москва', 'Музыка', 5500, 61, 2, 78, ABS(RANDOM()) % 1000 + 1, 550.0, 275),
('2025-03-01', 'Москва', 'Такси', 3400, 54, 2, 106, ABS(RANDOM()) % 1000 + 1, 340.0, 170),
('2025-03-01', 'Санкт-Петербург', 'Поиск', 5600, 44, 3, 142, ABS(RANDOM()) % 1000 + 1, 560.0, 280),
('2025-03-01', 'Санкт-Петербург', 'Карты', 4400, 54, 2, 99, ABS(RANDOM()) % 1000 + 1, 440.0, 220),
('2025-03-01', 'Санкт-Петербург', 'Музыка', 3400, 66, 1, 68, ABS(RANDOM()) % 1000 + 1, 340.0, 170),
('2025-03-01', 'Санкт-Петербург', 'Такси', 2400, 51, 2, 118, ABS(RANDOM()) % 1000 + 1, 240.0, 120),
('2025-03-01', 'Екатеринбург', 'Поиск', 3600, 46, 3, 132, ABS(RANDOM()) % 1000 + 1, 360.0, 180),
('2025-03-01', 'Екатеринбург', 'Карты', 2600, 55, 2, 90, ABS(RANDOM()) % 1000 + 1, 260.0, 130),
('2025-03-01', 'Екатеринбург', 'Музыка', 2900, 64, 1, 72, ABS(RANDOM()) % 1000 + 1, 290.0, 145),
('2025-03-01', 'Екатеринбург', 'Такси', 1600, 59, 2, 108, ABS(RANDOM()) % 1000 + 1, 160.0, 80),
-- Апрель 2025
('2025-04-01', 'Москва', 'Поиск', 9400, 44, 3, 124, ABS(RANDOM()) % 1000 + 1, 940.0, 470),
('2025-04-01', 'Москва', 'Карты', 7400, 55, 2, 96, ABS(RANDOM()) % 1000 + 1, 740.0, 370),
('2025-04-01', 'Москва', 'Музыка', 5600, 60, 2, 80, ABS(RANDOM()) % 1000 + 1, 560.0, 280),
('2025-04-01', 'Москва', 'Такси', 3500, 55, 2, 105, ABS(RANDOM()) % 1000 + 1, 350.0, 175),
('2025-04-01', 'Санкт-Петербург', 'Поиск', 5500, 45, 3, 140, ABS(RANDOM()) % 1000 + 1, 550.0, 275),
('2025-04-01', 'Санкт-Петербург', 'Карты', 4500, 53, 2, 100, ABS(RANDOM()) % 1000 + 1, 450.0, 225),
('2025-04-01', 'Санкт-Петербург', 'Музыка', 3500, 65, 1, 70, ABS(RANDOM()) % 1000 + 1, 350.0, 175),
('2025-04-01', 'Санкт-Петербург', 'Такси', 2500, 50, 2, 120, ABS(RANDOM()) % 1000 + 1, 250.0, 125),
('2025-04-01', 'Екатеринбург', 'Поиск', 3500, 47, 3, 130, ABS(RANDOM()) % 1000 + 1, 350.0, 175),
('2025-04-01', 'Екатеринбург', 'Карты', 2500, 54, 2, 91, ABS(RANDOM()) % 1000 + 1, 250.0, 125),
('2025-04-01', 'Екатеринбург', 'Музыка', 3000, 63, 1, 74, ABS(RANDOM()) % 1000 + 1, 300.0, 150),
('2025-04-01', 'Екатеринбург', 'Такси', 1500, 60, 2, 110, ABS(RANDOM()) % 1000 + 1, 150.0, 75);
